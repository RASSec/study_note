# vim 



## 恢复未正常退出文件

从交换文件恢复:

vim -r filename



## 交互模式



### 查找

最简单的就是`/正则`来查找

大小写敏感查找:`/foo\c`,`\c`大小写不敏感,`\C`大小写敏感

`:set incsearch` 可以在敲键的同时搜索，按下回车把移动光标移动到匹配的词； 按下 Esc 取消搜索。

`:set wrapscan` 用来设置到文件尾部后是否重新从文件头开始搜索。



### 替换

`:s`（substitute）命令用来查找和替换字符串。语法如下：

```
:{作用范围}s/{目标}/{替换}/{替换标志}
```

例如`:%s/foo/bar/g`会在全局范围(`%`)查找`foo`并替换为`bar`，所有出现都会被替换（`g`）。

#### 作用范围

作用范围分为当前行、全文、选区等等。

当前行：

```
:s/foo/bar/g
```

全文：

```
:%s/foo/bar/g
```

选区，在Visual模式下选择区域后输入`:`，Vim即可自动补全为 `:'<,'>`。

```
:'<,'>s/foo/bar/g
```

2-11行：

```
:5,12s/foo/bar/g
```

当前行`.`与接下来两行`+2`：

```
:.,+2s/foo/bar/g
```



#### 替换标志

### 替换标志

上文中命令结尾的`g`即是替换标志之一，表示全局`global`替换（即替换目标的所有出现）。 还有很多其他有用的替换标志：

空替换标志表示只替换从光标位置开始，目标的第一次出现：

```
:%s/foo/bar
```

`i`表示大小写不敏感查找，`I`表示大小写敏感：

```
:%s/foo/bar/i
# 等效于模式中的\c（不敏感）或\C（敏感）
:%s/foo\c/bar
```

`c`表示需要确认，例如全局查找`"foo"`替换为`"bar"`并且需要确认：

```
:%s/foo/bar/gc
```

回车后Vim会将光标移动到每一次`"foo"`出现的位置，并提示

```
replace with bar (y/n/a/q/l/^E/^Y)?
```

按下`y`表示替换，`n`表示不替换，`a`表示替换所有，`q`表示退出查找模式， `l`表示替换当前位置并退出。`^E`与`^Y`是光标移动快捷键，参考： [Vim中如何快速进行光标移动](https://harttle.land/2015/11/07/vim-cursor.html)。



### `0/Home`移动到行首,`$/End`移动到行尾



### w : 一个一个单词的移动



### x ：删除字符



### d:删除单词行等等(会将删除内容复制到内存,有点像剪切)

#### dd: 删除行



#### dw: 删除一个单词



#### `d0`:删除光标到行首之间的内容



#### `d$`:删除光标到行尾之间的内容



### y: 复制行到内存(命令类似于d,这里就不展开了)

`yy,yw,y0,y$`,y代表yank 是英语“拔出，抽出”的意思 

### p:粘贴



### u:撤销操作



## g:跳转到指定行

- 要跳转到最后一行，按下 G（大写的 G，Shift + g）
- 要跳转到第一行，按下 gg（按两次 g 键）
- 跳转到指定行：行号 + G 或 行号 + gg



## r:替换

用法:`rx `=>`用x来替换光标所在的字符`





### 数字+操作

如

```shell
4+w=>移动4个单词
100+dd=>删除100行
5+x=>删除5个字符
```







## 命令模式

### `:w`写入文件/另存为

`:w newfilename`:另存为



### `:wq/:x` 保存并退出



### `:s `查找并替换

```shell
:s/旧字符串/新字符串
#替换光标所在行的第一个匹配的旧字符串为新字符串。
:s/旧字符串/新字符串/g 
#替换光标所在行的所有匹配的旧字符串为新字符串。
:x,x s/旧字符串/新字符串/g 
#替换文件中第 x 行到第 x 行的所有匹配的旧字符串为新字符串。
:%s/旧字符串/新字符串/g 
#替换文件中所有匹配的字符串
```



### `:r` 合并文件

`:r 另一个文件名`



### 分屏

#### `:sp` ：横向分屏

`:sp 文件名`

#### `:vsp` ：垂直分屏

`:vsp 文件名`

#### 一些快捷键

| 按键                     | 作用                                                         |
| :----------------------- | :----------------------------------------------------------- |
| Ctrl + w 然后按 h        | 移动光标到左边的 viewport                                    |
| Ctrl + w 然后按 j        | 移动光标到下边的 viewport                                    |
| Ctrl + w 然后按 k        | 移动光标到上边的 viewport                                    |
| Ctrl + w 然后按 l        | 移动光标到右边的 viewport                                    |
| Ctrl + w 然后按 +        | 扩大当前 viewport                                            |
| Ctrl + w 然后按 -        | 缩小当前 viewport                                            |
| Ctrl + w 然后按 =        | 重新均匀分配各个 viewport 的占比                             |
| Ctrl + w 然后按 r        | 调换各个 viewport 的位置。用 R 的话是反向调换                |
| Ctrl + w 然后按 q 或按 c | 关闭当前 viewport。输入 `:quit` 或 `:close` 也有一样效果。q 是 quit 的缩写，表示“退出”。 c 是 close 的缩写，表示“关闭” |
| Ctrl + w 然后按 o        | 只保留当前所在 viewport，关闭其他 viewport。输入 `:only` 也有一样效果，o 是 only 的缩写，表示“仅仅，只” |



### `:!` ：运行外部命令



### `:set` 选项名

一旦 Vim 被打开后，要激活一个选项参数，只需要输入：

```
:set 选项名
```

set 是英语“设置”的意思。

而不激活（取消）一个选项参数，只需要输入：

```
:set no 选项名
```

有些选项参数需要被指定一个值，像这样：

```
:set 选项名=数值
```

如果想了解一个选项参数的状态，只需要输入：

```
:set 选项名?
```

在选项名后加一个问号（?）即可。

## 插入模式





## 配置

`cp /etc/vim/vimrc ~/.vimrc`



```shell
syntax on#语法高亮
set background=dark
set number #显示行号
showcmd：显示当前命令
set ignorecase #查找时忽略大小写
set mouse=a #激活鼠标操作

```

 https://github.com/amix/vimrc 



## 文档

 https://vimjc.com/ 

